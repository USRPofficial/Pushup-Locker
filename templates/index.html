<!DOCTYPE html>
<html>
<head>
    <title>Pushup Locker</title>
    <style>
        body { font-family: Arial; text-align: center; padding: 40px; }
        #lock { font-size: 24px; margin-top: 20px; }
        button { padding: 10px 20px; font-size: 18px; margin: 10px; }
    </style>
</head>
    <p style="color:red;">TEST LINE</p>

<body>
    <h1>Pushup Locker</h1>
    <p>You must complete your pushups before scrolling!</p>

    <div id="lock">Loading...</div>

    <button onclick="logPushups()">I did pushups</button>
    <button onclick="startEmergency()">Emergency Mode</button>

    <script>
        async function refresh() {
            let r = await fetch("/status");
            let data = await r.json();
            if (data.emergency) {
                document.getElementById("lock").innerText =
                    "Emergency mode active (" + data.time_left + "s left)";
            } else {
                document.getElementById("lock").innerText =
                    data.remaining + " pushups remaining";
            }
        }

        async function logPushups() {
            let amount = prompt("How many pushups?");
            if (!amount) return;
            await fetch("/log_pushups", {
                method: "POST",
                body: new URLSearchParams({ amount })
            });
            refresh();
        }

        async function startEmergency() {
            await fetch("/start_emergency", { method: "POST" });
            refresh();
        }

        setInterval(refresh, 1000);
        refresh();
    </script>

    <!-- â­ Staff Access Form (now correctly inside the body) -->
    <h3>Staff Access</h3>
    <form method="POST" action="/staff-code">
        <input type="password" name="code" placeholder="Enter staff code">
        <button type="submit">Enter</button>
    </form>

</body>
</html>

